<!DOCTYPE html><html><head><meta charset="utf-8"><title>Untitled Document.md</title><style></style></head><body id="preview">
<h1><a id="DATA_EXPLORATION_ANALYSIS_AND_VISUALIZATION_USING_APACHE_ZEPPELIN_0"></a>DATA EXPLORATION, ANALYSIS AND VISUALIZATION USING APACHE ZEPPELIN</h1>
<p><strong>Processing Engine Used</strong> : Apache Spark</p>
<p><strong>Language Used</strong> : SQL</p>
<p><strong>Executed on</strong> : Hadoop Big Data Platform</p>
<p><strong>Visualization tool used</strong> : Apache Zeppelin</p>
<h2><a id="OVERVIEW_11"></a>OVERVIEW</h2>
<p>This learning lab can be used as a guide to get a high level understanding of Apache Spark with Zeppelin. It describes how to interpret a pre-loaded static data, analyze and visualize the data using Zeppelin. The data resides in Hadoop environment and Zeppelin interacts with the data using Spark by forming RDD on the data set.</p>
<p>We will be using DevNet Data Learning Platform referred as “DLP” during the course.</p>
<h2><a id="PREREQUISITES_18"></a>PRE-REQUISITES</h2>
<ol>
<li>
<p>Install Chrome Browser.</p>
</li>
<li>
<p>Basic understanding of Apache Spark, Apache Hadoop and Big Data.</p>
</li>
<li>
<p>Basic knowledge of SQL (Structured Query Language).</p>
</li>
<li>
<p>Obtain access to Data Learning Platform -<br>
Refer: <a href="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/WORD%20COUNT%20USING%20SCALA%20WITH%20APACHE%20SPARK/HowToAccessDTLP.md">https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/WORD COUNT USING SCALA WITH APACHE SPARK/HowToAccessDTLP.md</a></p>
</li>
</ol>
<h2><a id="LEARNING_OBJECTIVES_29"></a>LEARNING OBJECTIVES</h2>
<ol>
<li>
<p>To get familiarized with the DLP (Data Learning Platform).</p>
</li>
<li>
<p>To get familiarized with the RDD operations on data using Apache Spark.</p>
</li>
<li>
<p>To get familiarized with the ways to read and format (CSV) HDFS files by using Apache Spark</p>
</li>
<li>
<p>To get familiarized with data analysis and visualization using Apache Zeppelin.</p>
</li>
</ol>
<h2><a id="TERMINOLOGIES_USED_40"></a>TERMINOLOGIES USED</h2>
<h3><a id="APACHE_ZEPPELIN__AN_INTRODUCTION_43"></a>APACHE ZEPPELIN - AN INTRODUCTION</h3>
<p>Zeppelin is a web-based notebook that enables interactive data analytics. You can make beautiful data-driven, interactive and collaborative documents with SQL, Scala and more.</p>
<p>Zeppelin enables data engineers, data analysts and data scientists to be more productive by developing, organizing, executing, and sharing data code and visualizing results without referring to the command line or knowing the cluster details. It brings data exploration, visualization, sharing and collaboration features to Spark. It supports Python and also a growing list of programming languages such as Scala, Hive, SparkSQL, shell and markdown. The various languages are supported via Zeppelin language interpreters. Zeppelin’s notebooks provides interactive snippet-at-time experience to data scientist.</p>
<h6><a id="Key_Features_50"></a>Key Features:</h6>
<ol>
<li>
<p>Web based notebook style editor.</p>
</li>
<li>
<p>Built-in Apache Spark support.</p>
</li>
</ol>
<h6><a id="Use_Cases_for_Zeppelin__56"></a>Use Cases for Zeppelin :</h6>
<ol>
<li>
<p>Data Exploration and discovery</p>
</li>
<li>
<p>Data Visualization - Tables, graphs and charts</p>
</li>
<li>
<p>Interactive snippet-at-a-time experience</p>
</li>
<li>
<p>Collaboration and publishing</p>
</li>
</ol>
<p>For more details, please refer : <a href="https://zeppelin.apache.org/">https://zeppelin.apache.org/</a></p>
<h3><a id="APACHE_SPARK__AN_INTRODUCTION_69"></a>APACHE SPARK - AN INTRODUCTION</h3>
<p>Apache Spark is an open source cluster computing framework. Spark is advertised as “lightning fast cluster computing”. It has a thriving open-source community and is the most active Apache project at the moment. Spark provides an interface for programming entire clusters with implicit data parallelism and fault-tolerance. Apache Spark provides programmers with an application programming interface centered on a data structure called the resilient distributed dataset (RDD), a read-only multiset of data items distributed over a cluster of machines, that is maintained in a fault-tolerant way.</p>
<p>It was developed in response to limitations in the MapReduce cluster computing paradigm, which forces a particular linear dataflow structure on distributed programs. MapReduce programs read input data from disk, map a function across the data, reduce the results of the map, and store reduction results on disk. Spark provides a faster and more general data processing platform.</p>
<h6><a id="Key_Features_75"></a>Key Features</h6>
<ol>
<li>Currently provides APIs in Scala, Java, and Python, with support for other languages (such as R) on the way</li>
<li>Integrates well with the Hadoop ecosystem and data sources (HDFS, Amazon S3, Hive, HBase, Cassandra, etc.)</li>
<li>Can run on clusters managed by Hadoop YARN or Apache Mesos, and can also run standalone</li>
</ol>
<h6><a id="How_to_Use_Apache_Spark_81"></a>How to Use Apache Spark?</h6>
<h6><a id="Example__Using_spark_to_detect_an_earthquake_by_analyzing_the_twitter_stream_83"></a>Example : Using spark to detect an earthquake by analyzing the twitter stream</h6>
<ol>
<li>
<p>Using Spark streaming, filter tweets that seem relevant like “earthquake” or “shaking”.</p>
</li>
<li>
<p>Run semantic analysis on the tweets to determine if they appear to be referencing a current earthquake occurrence. Tweets like “Earthquake!” or “Now it is shaking”, for example, would be considered positive matches, whereas tweets like “Attending an Earthquake Conference” or  “The earthquake yesterday was scary” would not.</p>
</li>
<li>
<p>Using the streaming technique we could detects the positive tweets in a defined time window and thereby can be used to send alert messages.</p>
</li>
</ol>
<p>For more details, please refer:<br>
<a href="http://spark.apache.org/">http://spark.apache.org/</a><br>
<a href="https://en.wikipedia.org/wiki/Apache_Spark">https://en.wikipedia.org/wiki/Apache_Spark</a></p>
<h2><a id="PROCESS_OVERVIEW_96"></a>PROCESS OVERVIEW</h2>
<p><img src="https://raw.githubusercontent.com/CiscoDevNet/data-dev-learning-labs/master/labs/WORD%20COUNT%20USING%20SCALA%20WITH%20APACHE%20SPARK/assets/images/Process2.jpeg?raw=true" alt="alt-tag"></p>
<p>Please follow the steps given below to launch the workspace and execute the word count program.</p>
<h3><a id="Step_1_Select_Learning_Lab_from_DLP_102"></a><strong>Step 1: Select Learning Lab from DLP</strong></h3>
<p>After launching the DLP dashboard page, navigate to learning labs tab. Select the learning lab “Data Exploration, Analysis and Visualization using Apache Zeppelin” and click on “Start” button as shown in screenshot below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore4.jpeg?raw=true" alt="Figure"></p>
<h3><a id="Step_2_Workspace_Page_108"></a><strong>Step 2: Workspace Page</strong></h3>
<p>On click of Start button, user will be navigated to a workspace page where all the components - IDE, Tools and Microservices required to execute the program are available. Please refer the screenshot below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore9.jpeg?raw=true" alt="Figure"></p>
<h3><a id="Step_3_Start_Service_in_Workspace_114"></a><strong>Step 3: Start Service in Workspace</strong></h3>
<p>Points to Note:</p>
<ul>
<li>Start Zeppelin service. Please refer screenshot below:</li>
</ul>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore2.png?raw=true" alt="Figure"></p>
<ul>
<li>Once started, the colour of the icon changes to green for launch button to be enabled. Please refer screenshot below:</li>
</ul>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore1.png?raw=true" alt="Figure"></p>
<ul>
<li>If the service is in stopped status then, click on it to start again.</li>
</ul>
<h3><a id="Step_4_Launch_Zeppelin_128"></a><strong>Step 4: Launch Zeppelin</strong></h3>
<p>Click on launch button and user will be navigated to Zeppelin home page.</p>
<p>Points to note:</p>
<p>(The pop-up may be blocked in browser configuration. Click on the red pop up blocker icon and select **Always allow pop-up from <a href="http://xxx.xxx.xxx.xxx">http://xxx.xxx.xxx.xxx</a> ** and click on <strong>Done</strong> button.)</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/popUpBlockerAllowed.PNG?raw=true" alt="Figure"></p>
<p>On enabling the pop-up, Zeppelin would open in a new window taking the user to Zeppelin home page as shown in screenshot below.</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore10.jpeg?raw=true" alt="Figure"></p>
<h3><a id="Step_5_Select_Zeppelin_notebook_143"></a><strong>Step 5: Select Zeppelin notebook</strong></h3>
<ul>
<li>Select pre-created notebook - “Basic Data Exploration And Analysis” from home page as shown in screenshot below:</li>
</ul>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore11.jpeg?raw=true" alt="Figure"></p>
<ul>
<li>The Zeppelin interactive, development and visualization environment is now ready for use. The pre-created notebook has all the codes required for executing this learning lab. Please refer the screenshot below. Each code shown below needs to be executed sequentially.</li>
</ul>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore5.jpeg?raw=true" alt="Figure"></p>
<h3><a id="Step_6_Execute_Apache_Spark_Code_153"></a><strong>Step 6: Execute Apache Spark Code</strong></h3>
<p>We are using code written in Apache Spark to create resilient distributed dataset (RDD) using bank-full.csv file. The file bank-full.csv is already loaded in Hadoop environment.</p>
<p>The code is as follows:</p>
<pre><code class="language-jason">val bankText = sc.textFile(&quot;hdfs://172.16.1.11:8020/user/U5850a40a98a794401f399c6f/99dd17b9-a13b-4fb0-ba97-c66fc7bd5ac0//bank-full.csv&quot;)  

case class Bank(age:Integer, job:String, marital : String, education : String, balance : Integer)

// split each line, filter out header (starts with &quot;age&quot;), and map it into Bank case class

val bank = bankText.map(s=&gt;s.split(&quot;;&quot;)).filter(s=&gt;s(0)!=&quot;\&quot;age\&quot;&quot;).map(  
       s=&gt;Bank(s(0).toInt, 
            s(1).replaceAll(&quot;\&quot;&quot;, &quot;&quot;),  
            s(2).replaceAll(&quot;\&quot;&quot;, &quot;&quot;),  
            s(3).replaceAll(&quot;\&quot;&quot;, &quot;&quot;),  
            s(5).replaceAll(&quot;\&quot;&quot;, &quot;&quot;).toInt  
        )  
)
bank.toDF().registerTempTable(&quot;bank&quot;)
</code></pre>
<p>Following functions are being done by the Spark Code :</p>
<ul>
<li>
<p>Header removal using filter function and data transformation from csv format into RDD of Bank objects.</p>
</li>
<li>
<p>RDD conversion to DataFrame and temporary table creation with name “bank”.</p>
</li>
</ul>
<p>Execute the code by clicking on the icon highlighted as shown in screenshot below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore6.jpeg?raw=true" alt="Figure"></p>
<p>On successful execution of code, the screen would be as shown in the screenshot below:</p>
<p>The icon changed to Finished and there would not be any errors shown on the screen.</p>
<p>Below screen shows that the spark RDD is created successfully and creation of a temporary table “bank” is also done:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore7.jpeg?raw=true" alt="Figure"></p>
<h3><a id="Step_7__SQL_Query_to_Retrieve_and_Visualize_data_198"></a><strong>Step 7 : SQL Query to Retrieve and Visualize data</strong></h3>
<p>We have now completed the data loading process. Next, we will use SQL queries in Zeppelin to retrieve and visualize the data loaded. Let’s try a few examples to visualize the data in Zeppelin.</p>
<p>**Example 1: ** Age distribution of data that is stored in bank RDD.</p>
<p>Execute the below mentioned query from Zeppelin Editor (Refer Example 1):</p>
<pre><code class="language-sql">%sql 
<span class="hljs-operator"><span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">from</span> bank <span class="hljs-keyword">where</span> age &lt; <span class="hljs-number">30</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age
</span></code></pre>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore12.jpeg?raw=true" alt="Figure"></p>
<p>The output is as shown below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore13.jpeg?raw=true" alt="Figure"></p>
<p>Change the graph type to pie chart and view the output as shown below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore14.jpeg?raw=true" alt="Figure"></p>
<p><strong>Example 2:</strong> Input run-time data as input box and display output.</p>
<p>Execute the below mentioned query from Zeppelin Editor (Refer Example 2):</p>
<pre><code class="language-sql">%sql
<span class="hljs-operator"><span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">count</span> <span class="hljs-keyword">from</span> bank <span class="hljs-keyword">where</span> age &lt; ${maxAge=<span class="hljs-number">30</span>} <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age
</span></code></pre>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore15.jpeg?raw=true" alt="Figure"></p>
<p>Enter value as 28 in the input box, select graph type as pie chart and view the output as shown below.</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore16.jpeg?raw=true" alt="Figure"></p>
<p><strong>Example 3:</strong> Using dynamic sql query to select data from a drop down list box.</p>
<p>Execute the below mentioned query from Zeppelin Editor (Refer Example 3):</p>
<pre><code class="language-sql">%sql
<span class="hljs-operator"><span class="hljs-keyword">select</span> age, <span class="hljs-keyword">count</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">count</span> <span class="hljs-keyword">from</span> bank <span class="hljs-keyword">where</span> marital = <span class="hljs-string">"${marital=single,single|divorced|married}"</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age
</span></code></pre>
<p>The output displays the age distribution with marital status and a combo box to select marital status as shown in the screenshot below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore18.jpeg?raw=true" alt="Figure"></p>
<p>Select value as “Married” from the combo box, select graph type as “Graph” and view the output as shown below:</p>
<p><img src="https://github.com/CiscoDevNet/data-dev-learning-labs/blob/master/labs/DATA%20EXPLORATION%2C%20ANALYSIS%20AND%20VISUALIZATION%20USING%20APACHE%20ZEPPELIN/assets/ZeppelinExplore19.jpeg?raw=true" alt="Figure"></p>
<h2><a id="LESSONS_LEARNT_255"></a>LESSONS LEARNT</h2>
<ol>
<li>
<p>How to perform RDD operations on data using Apache Spark.</p>
</li>
<li>
<p>How to read and format (CSV) HDFS files by using Apache Spark</p>
</li>
<li>
<p>How to do data analysis and visualization using Apache Zeppelin.</p>
</li>
</ol>
<h1><a id="Congratulations_You_have_successfully_completed_the_Learning_Lab__264"></a>**Congratulations! You have successfully completed the Learning Lab! **</h1>

</body></html>